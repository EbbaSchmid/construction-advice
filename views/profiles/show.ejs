<%- include('../partials/html-head') %>
<%- include('../partials/nav') %>

<main>
  <div>
    <img
      class="profile-avatar"
      src="<%= profile.avatar %>" 
      alt="<%= profile.name %>'s avatar"
    >
  </div>
  <%# isSelf replaces profile._id.equals(user.profile._id) %> 
  <h1>It's <%= isSelf ? "you" : profile.name %>!</h1>
  <% if (isSelf) { %>
    <h2>Add an icon!</h2>
    <form action="/profiles/<%= profile._id %>/icon" method="POST">
      <label>
        Name:
        <input type="text" name="name" autocomplete="off">
      </label>
      <label>
        Trade:
        <input type="text" name="trade" autocomplete="off">
      </label>
      <label>
        Years of Experience:
        <input type="number" name="years" autocomplete="off">
      </label>
      <button type="submit">Add</button>
    </form>
  <% } %>
  <% if (profile.cats.length) { %>
    <%# THERE ARE CATS FOR THIS PROFILE %> 
    <h2>
      <%= isSelf ? "You have" : `${profile.name} has` %> cats! Here they are! 
    </h2>
    <% profile.cats.forEach(cat => { %>
      <h3>
        <%= getRandomCat() %>
        <%= cat.name %> is a <%= cat.age %> year old <%= cat.breed %>.   
        <% if (isSelf) { %>
          <form 
            action="/profiles/cats/<%= cat._id %>?_method=DELETE"
            method="POST"
            style="display: inline-block;"
          >
            <button type="submit">ðŸ˜¸ Free <%= cat.name %></button>
          </form>
        <% } %>
      </h3>
    <% }) %>
  <% } else { %>
    <%# NO CATS FOR THIS PROFILE %>  
    <h2>
      <%= isSelf ? "You don't" : `${profile.name} doesn't` %> have any cats! 
    </h2>
  <% } %>
</main>

<%- include('../partials/footer') %>